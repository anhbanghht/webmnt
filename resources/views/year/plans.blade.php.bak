@extends('layouts.default')

@section('content')
<section>
    <div class="section-body contain-lg">
        <!-- BEGIN INTRO -->
    		<div class="row">
    			<div class="col-lg-12">
    				<h1 class="text-primary">Nội dung kế hoạch trong {{$year->year}} </h1>
    			</div><!--end .col -->
    		</div><!--end .row -->
    	<!-- END INTRO -->
    	<div class="row">
        	<div class="col-lg-12">
    			<div class="card">
    				<div class="card-body">
    				    @if( \Auth::user()->has_permission( 'plan::add' ) )
    				    <a href="{{route('plan::add')}}" class="btn ink-reaction btn-primary"><span class="fa fa-plus"></span></a>
    				    @endif
    					<div class="table-responsive">
    						<table class="table no-margin">
    							<thead>
    								<tr>
    									<th>ID</th>
    									<th width="450px">Tên kế hoạch</th>
    									<th>Ngày bắt đầu</th>
    									<th>Ngày kết thúc</th>
    									<th>Năm học</th>
    									<th>Loại thực tập</th>
    									<th width="450px">Mô tả</th>
    									<th width="450px">Nội dung</th>
    									<th>Ghi chú</th>
    									<th width="450px">Hành động</th>
    								</tr>
    							</thead>
    							<tbody>
    							    @if( $plan->isEmpty() )
    							    <tr>
    									<td colspan="10">Không có bản ghi nào!</td>
    								</tr>
    							    @else
    							    @foreach( $plan as $item )
    							    <tr>
    									<td>{{$item->id}}</td>
    									<td width="450px">{{$item->plan_name}}</td>
    									<td>{{ Date('Y/m/d',strtotime($item->startdate)) }}</td>
    									<td>{{ Date('Y/m/d',strtotime($item->enddate)) }}</td>
    									<td>{{$item->year->year}}</td>
    									<td>{{$item->intership_time->intership_type->intertype_name}}</td> 
    									<td width="450px">{{$item->description}}</td>
    									<td width="450px">{{$item->content}}</td>
    									<td>{{$item->note}}</td>
    									<td width="450px">
    									    @if( \Auth::user()->has_permission( 'plan::view' ) )
    									    <a href="{{route('plan::view',['id'=>$item->id])}}" class="btn ink-reaction btn-primary" data-toggle="tooltip" data-placement="top" data-original-title="Thông tin kế hoạch thực tập"><span class="glyphicon glyphicon-eye-open"></span></a>
    									    @endif
    									    @if( \Auth::user()->has_permission( 'plan::edit' ) )
    									    <a href="{{route('plan::edit',['id'=>$item->id])}}" class="btn ink-reaction btn-primary"><span class="glyphicon glyphicon-pencil"></span></a>
    									    @endif
    									    @if( \Auth::user()->has_permission( 'plan::delete' ) )
    									    <a href="{{route('plan::delete',['id'=>$item->id])}}" class="btn ink-reaction btn-primary remove-btn"><span class="glyphicon glyphicon-remove"></span></a>
    									    @endif
    									</td>
    								</tr>
    							    @endforeach
    								@endif
    							</tbody>
    						</table>
    					</div><!--end .table-responsive -->
    				</div><!--end .card-body -->
    			</div><!--end .card -->
    		</div>
		</div>
		
    </div>
</section>
@stop
@section('addtional-js')
<script>
    (function($){
        var token = "{{csrf_token()}}";
        $('.remove-btn').click(function(e){
           e.preventDefault();
           var link = $(e.currentTarget).attr('href');
           $.ajax({
               url: link,
               data: '_token='+token,
               method: 'POST'
           }).done(function(data){
              window.location.reload(); 
           });
        });
    })(jQuery);
</script>
@stop